{{ define "main" }}
<section class="hero">
  <div class="container hero-grid">
    <div class="hero-copy">
      <h1>Central Coast Biological Society</h1>
      <p class="tagline">Connecting biologists, educators, and nature enthusiasts across the Central Coast since 1986.
      </p>


    </div>

  </div>
</section>

<section class="next-event" id="next-event">
  <div class="container narrow">
    <div class="section-heading">
      <p class="eyebrow">Next Meeting</p>
      {{ with .Site.Data.next_event }}
      <h2>{{ .theme }}</h2>
      {{ if .note }}<p class="lede">{{ .note }}</p>{{ end }}
    </div>

    <div class="event-card">
      <div class="event-date">
        <span class="month">{{ .month }}</span>
        <span class="day">{{ .day }}</span>
        <span class="year">{{ .year }}</span>
      </div>
      <div class="event-details">

        <div class="event-meta">
          <div class="meta-row">
            <svg class="meta-icon" xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 24 24" width="20px"
              fill="currentColor">
              <path
                d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z" />
            </svg>
            <span class="meta-text">{{ .time }}</span>
          </div>

          <div class="meta-row align-start">
            <svg class="meta-icon" xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 24 24" width="20px"
              fill="currentColor">
              <path
                d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
              <path d="M0 0h24v24H0z" fill="none" />
            </svg>
            <div class="meta-location-group">
              <span class="location-name">{{ .location }}</span>
              {{ if .address }}<span class="location-address">{{ .address }}</span>{{ end }}
              <a href="https://www.google.com/maps/search/?api=1&query={{ .location }}{{ if .address }} {{ .address }}{{ end }}"
                target="_blank" rel="noopener noreferrer" class="map-link">Get Directions &rarr;</a>
            </div>
          </div>
        </div>

        <div class="event-actions" style="margin-bottom: 1.5rem; display: flex; gap: 0.75rem; flex-wrap: wrap;">
          <a href="#" id="add-to-google" class="btn subtle" target="_blank" rel="noopener noreferrer"
            data-title="Central Coast Biological Society Meeting"
            data-date="{{ .month }} {{ .day }}, {{ .year }} {{ .time }}" data-location="{{ .location }}, {{ .address }}"
            data-description="{{ .theme }}. {{ .note }}">
            Google Calendar
          </a>
          <a href="#" id="add-to-ics" class="btn subtle" download="event.ics">
            Apple / Outlook
          </a>
        </div>

        <script>
          (function () {
            const googleBtn = document.getElementById('add-to-google');
            const icsBtn = document.getElementById('add-to-ics');
            if (!googleBtn || !icsBtn) return;

            const dateStr = googleBtn.dataset.date; // e.g., "Feb 17, 2026 6:00 PM"
            const eventDate = new Date(dateStr);

            if (isNaN(eventDate)) return; // Invalid date

            // Assume 2 hour duration
            const endDate = new Date(eventDate.getTime() + 2 * 60 * 60 * 1000);

            const formatDate = (date) => {
              return date.toISOString().replace(/-|:|\.\d\d\d/g, "");
            };

            const start = formatDate(eventDate);
            const end = formatDate(endDate);
            const title = googleBtn.dataset.title;
            const description = googleBtn.dataset.description;
            const location = googleBtn.dataset.location;

            // Google Calendar
            const googleUrl = new URL('https://www.google.com/calendar/render');
            googleUrl.searchParams.append('action', 'TEMPLATE');
            googleUrl.searchParams.append('text', title);
            googleUrl.searchParams.append('dates', `${start}/${end}`);
            googleUrl.searchParams.append('details', description);
            googleUrl.searchParams.append('location', location);

            googleBtn.href = googleUrl.toString();

            // ICS File
            const icsContent = [
              'BEGIN:VCALENDAR',
              'VERSION:2.0',
              'BEGIN:VEVENT',
              'URL:' + document.URL,
              'DTSTART:' + start,
              'DTEND:' + end,
              'SUMMARY:' + title,
              'DESCRIPTION:' + description,
              'LOCATION:' + location,
              'END:VEVENT',
              'END:VCALENDAR'
            ].join('\n');

            icsBtn.href = 'data:text/calendar;charset=utf8,' + encodeURIComponent(icsContent);
          })();
        </script>

        <div class="speakers-section">
          {{ range .speakers }}
          <div class="speaker">
            <span class="speaker-name">{{ .name }}</span>
            <span class="speaker-title">{{ .title }}</span>
          </div>
          {{ end }}
        </div>
      </div>
    </div>
    {{ else }}
    <p class="no-event">Check back soon for our next event announcement!</p>
    {{ end }}
  </div>
</section>



<section class="cta">
  <div class="container cta-grid">
    <div class="cta-card">
      <p class="eyebrow">Stay connected</p>
      <h3>Join the mailing list</h3>
      <p>Get 3–4 emails per year with meeting dates, themes, and field trip plans.</p>
      <a class="btn" href="{{ `join/` | absLangURL }}">Sign up</a>
    </div>
    <div class="cta-card">
      <p class="eyebrow">Explore</p>
      <h3>Talk history</h3>
      <p>Browse past programs—from Morro manzanita and nudibranchs to condors and soil fungi.</p>
      <a class="btn ghost" href="{{ `talks/` | absLangURL }}">See the archive</a>
    </div>
    <div class="cta-card">
      <p class="eyebrow">Lead</p>
      <h3>Steering Committee</h3>
      <p>Help shape future topics, field trips, and community connections.</p>
      <a class="btn ghost" href="{{ `committee/` | absLangURL }}">Meet the committee</a>
    </div>
  </div>
</section>
{{ end }}
